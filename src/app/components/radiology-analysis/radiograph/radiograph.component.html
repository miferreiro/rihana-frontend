
<!--
  ~ RIHANA Frontend
  ~
  ~ Copyright (C) 2021 David A. Ruano Ordás, José Ramón Méndez Reboredo,
  ~ Miguel Ferreiro Díaz
  ~
  ~ This program is free software: you can redistribute it and/or modify
  ~ it under the terms of the GNU General Public License as
  ~ published by the Free Software Foundation, either version 3 of the
  ~ License, or (at your option) any later version.
  ~
  ~ This program is distributed in the hope that it will be useful,
  ~ but WITHOUT ANY WARRANTY; without even the implied warranty of
  ~ MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  ~ GNU General Public License for more details.
  ~
  ~ You should have received a copy of the GNU General Public
  ~ License along with this program.  If not, see
  ~ <http://www.gnu.org/licenses/gpl-3.0.html>.
-->

<div class="row align-items-center">
	<div class="col-xxl-6 col-12">
		<ng-template [ngIf]="typeExploration === 'PA'">
			<h3 class="fw-bold">{{'Postero-anterior radiograph (PA)' | translate}}</h3>
		</ng-template>
		<ng-template [ngIf]="typeExploration === 'AP'">
			<h3 class="fw-bold">{{'Antero-posterior radiograph (AP)' | translate}}</h3>
		</ng-template>
		<ng-template [ngIf]="typeExploration === 'LAT'">
			<h3 class="fw-bold">{{'Lateral radiograph (LAT)' | translate}}</h3>
		</ng-template>
	</div>
	<div class="col-xxl-6 col-12">
		<div class="row">
			<div *ngIf="checkState('NOT_LOADED') || checkState('RADIOGRAPH_LOADED') || checkState('EXPLORATION_LOADED')"
				[ngClass]="{'col-6': checkState('NOT_LOADED'),
							'col-12': !checkState('NOT_LOADED')}">
				<div class="file-drop-zone" file-drop-zone [control]="controlRadiograph">
					<label *ngIf="checkState('NOT_LOADED')" class="upload-input">
						<div class="col text-center">
							<i class="las la-file-upload la-lg" style="color: black;"></i>
						</div>
						<div class="col text text-center">
							{{'Drag and Drop the image or click here' | translate}}
						</div>
						<input name="inputRadiograph" class="files-input" type="file" accept="image/*"
								(change)="addRadiograph($event)" onclick="this.value = null">
					</label>

					<ng-template #placeholder>
						<div class="overlayCustom">
							<div class="text-center">
								<i class="las la-file-upload la-lg" style="color: black;"></i>
							</div>
							<div class="dragover-text">
								{{'Drop it here' | translate}}
							</div>
						</div>
					</ng-template>

					<div *ngIf="checkState('RADIOGRAPH_LOADED') || checkState('EXPLORATION_LOADED')">
						<div class="upload-list">
							<div>
								<div class="file-upload-icon">
									<i class="las la-file-image position-relative top-50 start-50 translate-middle" style="font-size: 1.5rem;color: black;"></i>
								</div>
								<div class="file-info">
									{{controlRadiograph.value[0].name}} ({{controlRadiograph.value[0].size | humanFileSize}})
								</div>
								<div class="file-buttons">
									<span class="remove-btn" (click)="removeRadiograph()">
										<i class="las la-trash-alt la-lg" style="color: black;"></i>
										{{'Remove' | translate}}
									</span>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div *ngIf="checkState('NOT_LOADED') || checkState('CLIPBOARD_LOADED') || checkState('READ_ONLY')"
					[ngClass]="{'col-6': checkState('NOT_LOADED'),
								'col-12': !checkState('NOT_LOADED')}">
				<div *ngIf="checkState('NOT_LOADED')" class="file-paste-zone text-center" (click)="onPaste($event)">
					<i class="las la-clipboard la-lg" style="color: black;"></i>
					<p>
						{{'Click here to paste from clipboard' | translate}}
					</p>
				</div>
				<div *ngIf="checkState('CLIPBOARD_LOADED')" class="file-paste-zone text-center">
					<p>
						{{'Radiograph loaded correctly from clipboard' | translate}}
					</p>
					<div class="file-buttons">
						<span class="remove-btn" (click)="removeRadiograph()">
							<i class="las la-trash-alt la-lg" style="color: black;"></i>
							{{'Remove' | translate}}
						</span>
					</div>
				</div>
			</div>
			<div *ngIf="checkState('READ_ONLY')" class="file-paste-zone text-left defaultCursor">
				<div class="upload-list">
					<div class="file-upload-icon">
						<i class="las la-file-image la-lg position-relative top-50 start-50 translate-middle" style="font-size: 1.5rem;color: black;"></i>
					</div>
					<div class="file-info">
						{{controlRadiograph.value[0].name}} ({{controlRadiograph.value[0].size | humanFileSize}})
					</div>
				</div>
			</div>
		</div>
	</div>
</div>
<div *ngIf="controlRadiograph.value.length > 0 && radiograph != undefined" id="radiographInfo" class="row mb-3 mt-3">
	<div class="row">
		<h4 class="col">{{'Signs detected' | translate}}: {{radiograph.signs ? radiograph.signs.length : '0' }}</h4>
		<span class="col text-end">
			<i *ngIf="!checkState('READ_ONLY')" class="las la-edit la-lg" (click)="openDialogImage()"></i>
			<i class="las la-eye la-lg" (click)="openDialogImage()"></i>
		</span>
	</div>
	<div class="row signs">
		<ul>
			<li *ngFor="let signType of signTypesRadiograph" class="col-lg-4 col-md-6 col-12 align-self-center">
				<div *ngIf="signType.code != 'NOF' && signType.code != 'OTH'" class="signType my-1"
					 [ngStyle]="{'border-color': signType.primaryColor}">
					<span>{{signType.name | translate}}</span>
					<span class="numSignType badge rounded-pill"
						  [ngStyle]="{'background-color': signType.primaryColor, 'color': signType.secondaryColor}">
							{{getNumSignType(signType)}}
					</span>
				</div>
				<div *ngIf="signType.code == 'NOF' || signType.code == 'OTH'" class="signType my-1"
				   [ngStyle]="{'border-color': signType.primaryColor}">
					{{signType.name | translate}}
				</div>
			</li>
		</ul>
	</div>
	<div *ngIf="!checkState('READ_ONLY') || (checkState('READ_ONLY') && radiograph.observations != null)" class="row mt-4">
		<h4 class="col">{{'Observations' | translate}}: </h4>
		<textarea *ngIf="!checkState('READ_ONLY')" name="observations" class="form-control" style="max-height:100px"
				  rows="2" maxlength="3000" [(ngModel)]="radiograph.observations"
				  placeholder="{{'Add your observations here' | translate}}..."></textarea>
		<p *ngIf="checkState('READ_ONLY')">
			{{radiograph.observations}}
		</p>
	</div>
</div>

<app-locate-signs-in-image-dialog
	*ngIf="showImageDialog"
	(close)="closeDialogImage($event)"
	[src]="uploadedFile | async"
	[signs]="radiograph.signs"
	[disabled]="checkState('READ_ONLY')">
</app-locate-signs-in-image-dialog>

<simple-notifications></simple-notifications>