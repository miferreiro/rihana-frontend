<!--
  ~ RIHANA Frontend
  ~
  ~ Copyright (C) 2021 David A. Ruano Ordás, José Ramón Méndez Reboredo,
  ~ Miguel Ferreiro Díaz
  ~
  ~ This program is free software: you can redistribute it and/or modify
  ~ it under the terms of the GNU General Public License as
  ~ published by the Free Software Foundation, either version 3 of the
  ~ License, or (at your option) any later version.
  ~
  ~ This program is distributed in the hope that it will be useful,
  ~ but WITHOUT ANY WARRANTY; without even the implied warranty of
  ~ MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  ~ GNU General Public License for more details.
  ~
  ~ You should have received a copy of the GNU General Public
  ~ License along with this program.  If not, see
  ~ <http://www.gnu.org/licenses/gpl-3.0.html>.
-->

<div class="row mt-4 mb-4">
	<div class="row align-items-center">
		<div class="col-xxl-6 col-12 d-flex align-items-center justify-content-around">
			<h3 class="text-center fw-bold">{{'Radiology report' | translate}}</h3>
			<div class="report-show" *ngIf="isReportLoaded">
				<i id="expandControl" class="bi bi-eye-slash" (click)="expandReport()"></i>
			</div>
		</div>
		<div class="col-xxl-6 col-12">
			<div class="row">
				<div *ngIf="!isReportLoaded && controlReport.value.length == 0 ||
							isReportLoaded && controlReport.value.length > 0"
					 [ngClass]="{'col-6': !isReportLoaded,
								 'col-12': isReportLoaded && controlReport.value.length > 0}">
					<div class="file-drop-zone" file-drop-zone [control]="controlReport">
						<label class="upload-input ng-trigger ng-trigger-zoomAnimation">
							<div class="col text-center">
								<i class="bi bi-upload" style="font-size: 1rem; color: black;"></i>
							</div>
							<div *ngIf="controlReport.size === 0" class="col text text-center">
								{{'Drag and Drop the file or click here' | translate}}
							</div>
							<input class="files-input" type="file" accept=".pdf"
								(change)="addFile($event)" onclick="this.value = null">
						</label>

						<ng-template #placeholder>
							<div class="overlayCustom">
								<div class="text-center">
									<i class="bi bi-upload" style="font-size: 1rem; color: black;"></i>
								</div>
								<div class="dragover-text">
									{{'Drop it here' | translate}}
								</div>
							</div>
						</ng-template>

						<div *ngIf="controlReport.value.length > 0">
							<div class="upload-list">
								<div>
									<div class="file-upload-icon">
										<i class="bi bi-file-earmark-pdf " style="font-size: 1rem; color: black;"></i>
									</div>
									<div class="file-info">
										{{controlReport.value[0].name}} ({{controlReport.value[0].size | humanFileSize}})
									</div>
									<div class="file-buttons">
										<span class="remove-btn" (click)="removeReport()">
											<i class="bi bi-trash-fill" style="color: black;"></i>
											{{'Remove' | translate}}
										</span>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
				<div *ngIf="!isReportLoaded && controlReport.value.length == 0 ||
							isReportLoaded && controlReport.value.length == 0"
					 [ngClass]="{'col-6': !isReportLoaded,
								 'col-12': isReportLoaded && controlReport.value.length == 0}">
					<div *ngIf="!isReportLoaded" class="file-paste-zone text-center" (click)="onPaste($event)">
						<i class="bi bi-clipboard"></i>
						<p>
							{{'Click here to paste from clipboard' | translate}}
						</p>
					</div>
					<div *ngIf="isReportLoaded && exploration.title == undefined" class="file-paste-zone text-center">
						<p>
							{{'Report loaded correctly from clipboard' | translate}}
						</p>
						<div class="file-buttons">
							<span class="remove-btn" (click)="removeReport()">
								<i class="bi bi-trash-fill" style="color: black;"></i>
								{{'Remove' | translate}}
							</span>
						</div>
					</div>
					<div *ngIf="isReportLoaded && exploration.title != undefined"
						 class="file-paste-zone defaultCursor text-center">
						<p>
							{{'Report loaded correctly' | translate}}
						</p>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div *ngIf="patient.hasOwnProperty('birthdate')" id="dataReport" class="row mb-3 mt-3">
		<div class="align-items-center patient-info">
			<legend class="fw-bold">{{'Patient information' | translate}}</legend>
			<div class="row">
				<div class="col-md-3 col-sm-6 col-xs-12">
					<p class="text-nowrap fw-bold">{{'Birthdate' | translate}}</p>
				</div>
				<div class="col-md-3 col-sm-6 col-xs-12">
					<p>{{patient.hasOwnProperty("birthdate") ? (patient.birthdate | date:'dd/MM/yyyy') : ""}}</p>
				</div>
				<div class="col-md-3 col-sm-6 col-xs-12">
					<p class="fw-bold">{{'Sex' | translate}}</p>
				</div>
				<div class="col-md-3 col-sm-6 col-xs-12">
					<p>{{patient.hasOwnProperty("sex") ? (patient.sex | translate) : ""}}</p>
				</div>
			</div>
		</div>
		<div class="row align-items-center">
			<div class="col-md-3 col-sm-6 col-xs-12">
				<p class="fw-bold">{{'Completion date' | translate}}</p>
			</div>
			<div class="col-md-3 col-sm-6 col-xs-12">
				<p>{{report.hasOwnProperty("completionDate") ? (report.completionDate | date:'dd/MM/yyyy') : ""}}</p>
			</div>
			<div class="col-md-3 col-sm-6 col-xs-12">
				<p class="fw-bold">{{'Report number' | translate}}</p>
			</div>
			<div class="col-md-3 col-sm-6 col-xs-12">
				<p>{{report.hasOwnProperty("reportNumber") ? report.reportNumber : ""}}</p>
			</div>
		</div>
		<div class="row align-items-center">
			<div class="col-md-6 col-sm-6 col-xs-12">
				<p class="fw-bold">
					<span class="text-uppercase">{{'Applicant' | translate}}</span>
					{{'Center/Service' | translate}}
				</p>
			</div>
			<div class="col-md-6 col-sm-6 col-xs-12">
				<p>{{report.hasOwnProperty("applicant") ? report.applicant : ""}}</p>
			</div>
		</div>
		<div class="row align-items-center">
			<div class="col-md-3 col-sm-12 col-xs-12">
				<p class="fw-bold text-nowrap">
					<span class="text-uppercase">{{'Patient status' | translate}}</span>:
				</p>
			</div>
			<div class="col-md-3 col-sm-4 col-xs-12">
				<p class="text-nowrap">
					<span class="fw-bold">{{'Priority' | translate}}</span>
					{{report.hasOwnProperty("priority") ? report.priority : ""}}
				</p>
			</div>
			<div class="col-md-3 col-sm-4 col-xs-12">
				<p class="fw-bold">{{'Admitted' | translate}}</p>
			</div>
			<div class="col-md-3 col-sm-4 col-xs-12">
				<p>
					<span class="fw-bold">{{'Bed' | translate}}</span>
					{{report.hasOwnProperty("bed") ? report.bed : ""}}
				</p>
			</div>
		</div>
		<div class="row">
			<p class="fw-bold text-uppercase">{{'Requested explorations' | translate}}</p>
			<div class="table-responsive-md text-nowrap">
				<table class="table table-borderless text-center">
					<thead>
						<tr>
							<th scope="col">{{'Code' | translate}}</th>
							<th scope="col">{{'Description' | translate}}</th>
							<th scope="col">{{'Date' | translate}}</th>
						</tr>
					</thead>
					<tbody>
						<tr *ngFor="let exploration of report.requestedExplorations">
							<td>{{exploration.code}}</td>
							<td>{{exploration.description}}</td>
							<td>{{exploration.date | date:'dd/MM/yyyy'}}</td>
						</tr>
					</tbody>
				</table>
			</div>
		</div>
		<div class="row">
			<p class="fw-bold text-uppercase">{{'Clinical data/Diagnostic suspicion of the application' | translate}}</p>
			<p>{{report.hasOwnProperty("clinicalData") ? report.clinicalData : ""}}</p>
		</div>
		<div class="row">
			<p class="fw-bold text-uppercase">{{'Performed explorations' | translate}}</p>
			<div class="table-responsive-md text-nowrap">
				<table class="table table-borderless text-center">
					<thead>
						<tr>
							<th scope="col">{{'Code' | translate}}</th>
							<th scope="col">{{'Description' | translate}}</th>
							<th scope="col">{{'Date' | translate}}</th>
							<th scope="col">{{'Portable' | translate}}</th>
							<th scope="col">{{'Surgery' | translate}}</th>
						</tr>
					</thead>
					<tbody>
						<tr *ngFor="let exploration of report.performedExplorations;">
							<td>{{exploration.code}}</td>
							<td>{{exploration.description}}</td>
							<td>{{exploration.date | date:'dd/MM/yyyy'}}</td>
							<td>{{exploration.portable}}</td>
							<td>{{exploration.surgery}}</td>
						</tr>
					</tbody>
				</table>
			</div>
		</div>
		<div class="row">
			<p class="fw-bold text-uppercase">{{'Findings' | translate}}</p>
			<p>{{report.hasOwnProperty("findings") ? report.findings : ""}}</p>
		</div>
		<div class="row">
			<p class="fw-bold text-uppercase">{{'Conclusions' | translate}}</p>
			<p>{{report.hasOwnProperty("conclusions") ? report.conclusions : ""}}</p>
		</div>
	</div>
</div>

<simple-notifications></simple-notifications>